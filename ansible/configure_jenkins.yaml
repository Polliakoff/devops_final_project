- hosts: master-node
  become: yes
  tasks:
    - name: add Jennkins user to docker group
      ansible.builtin.user:
        name: jenkins
        groups: docker
        append: yes

    - name: provide Jenkins user with Kubernetes config
      shell: |
        mkdir /var/lib/jenkins/.kube/ 
        cp /home/user_for_ansible/.kube/config /var/lib/jenkins/.kube/ 
        chown -R jenkins: /var/lib/jenkins/.kube/
      args:
        creates: /var/lib/jenkins/.kube/config

    - name: reboot machine to apply changes
      ansible.builtin.reboot:

    - name: restart kubelet to ensure cluster avaliability
      ansible.builtin.systemd:
        name: kubelet
        state: restarted

   
